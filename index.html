<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>นินจา + พื้นหลังเตี้ยลง</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
    canvas {
      background: #000;
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const background = new Image();
    background.src = "bg_forest_654x854.png"; // พื้นหลังขนาดจริง

    const sprite = new Image();
    sprite.src = "player_idle.png"; // Sprite ตัวละคร 768x128 (6 เฟรม)

    const frameWidth = 128;
    const frameHeight = 128;
    const totalFrames = 6;
    const scale = 3;
    const scaledWidth = frameWidth * scale;
    const scaledHeight = frameHeight * scale;

    let currentFrame = 0;
    let frameCount = 0;
    const frameSpeed = 8;

    function draw() {
      const bgOriginalWidth = 654;
      const bgOriginalHeight = 854;

      // คำนวณให้ภาพเต็มแนวกว้าง
      const bgDrawWidth = canvas.width;
      const bgScaleRatio = bgDrawWidth / bgOriginalWidth;

      // ลดความสูงลงเหลือ 1/2 เท่า (ต่ำลง 2 เท่า)
      const bgDrawHeight = (bgOriginalHeight * bgScaleRatio) / 2;

      // วางภาพพื้นหลังไว้ตรงกลางแนวตั้ง (หรือปรับตามต้องการ)
      const bgX = 0;
      const bgY = (canvas.height - bgDrawHeight) / 2;

      // วาดพื้นหลัง
      ctx.drawImage(background, bgX, bgY, bgDrawWidth, bgDrawHeight);

      // วางตัวละครยืนบนพื้นของพื้นหลัง
      const playerX = bgX + 100;
      const playerY = bgY + bgDrawHeight - scaledHeight;

      // วาดตัวละคร
      ctx.drawImage(
        sprite,
        currentFrame * frameWidth, 0,
        frameWidth, frameHeight,
        playerX, playerY,
        scaledWidth, scaledHeight
      );

      frameCount++;
      if (frameCount >= frameSpeed) {
        currentFrame = (currentFrame + 1) % totalFrames;
        frameCount = 0;
      }

      requestAnimationFrame(draw);
    }

    let loaded = 0;
    function checkLoaded() {
      loaded++;
      if (loaded === 2) draw();
    }

    background.onload = checkLoaded;
    sprite.onload = checkLoaded;
  </script>
</body>
</html>